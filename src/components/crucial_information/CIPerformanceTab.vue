<template>  <div>    <b-col cols="12">      <b-row style="min-width: 1025px">        <b-col class="pl-0">          <CIPerfCard :data="employee_checklist.dashboard" :date="weekDate" />        </b-col>      </b-row>    </b-col>    <b-col cols="12" class="pt-3 pl-0">      <b-row>        <b-col cols="12">          <div class="card p-3">            <h4 class="font-weight-bold">Daily check</h4>            <b-row>              <div class="col-md pt-3">                <swiper                  ref="cardSwiper"                  :options="swiperOption"                  class="d-flex p-1"                >                  <swiper-slide                    v-for="(cardData, indx) in daily_check_info"                    :key="indx"                    class="justify-content-center"                  >                    <CICard :week="cardData" :name="cards[indx]" :type="type" />                  </swiper-slide>                </swiper>              </div>            </b-row>          </div>        </b-col>      </b-row>    </b-col>    <b-col cols="12" class="pt-3 pl-0">      <b-row>        <b-col cols="12">          <div class="card pt-4 pl-4 pr-3 pb-3 bg-white">            <h4 class="font-weight-bold">This week planned task</h4>            <Table              v-if="renderComponent"              :tasks="planned_tasks"              :week-date="weekDate"              class="pt-3"            />          </div>        </b-col>      </b-row>    </b-col>    <CreateCI04      v-if="$store.getters['CICreateSideMenu']"      :sidebar-toggle="$store.getters['CICreateSideMenu']"    />  </div></template><script>import CICard from '@/components/crucial_information/CICard';import CIPerfCard from '@/components/crucial_information/CIPerfCards';import Table from '@/components/crucial_information/tables/CI04Table';import CreateCI04 from '@/components/crucial_information/CreateCI4';import { Swiper, SwiperSlide } from 'vue-awesome-swiper';import 'swiper/swiper-bundle.css';export default {  name: 'CIPerformanceTab',  components: {    CICard,    CIPerfCard,    CreateCI04,    Table,    Swiper,    SwiperSlide,  },  data() {    return {      swiperOption: {        slidesPerView: 3,        spaceBetween: 20,        updateOnWindowResize: false,        grabCursor: true,        // centeredSlides: true,        // freeMode: true,      },      renderComponent: true,      cards: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],      type: null,      weekDate: '',      employee_checklist: {        dashboard: {},      },      daily_check_info: [],      planned_tasks: [],      TaskDetails: [],    };  },  head() {    return {      title: 'АЧ Мэдээлэл | ТУС Д+',    };  },  watch: {    '$store.state.check.CICreateSideMenuToggle'(data) {      if (!data) {        const params = '?' + this.type + '=' + this.$route.params.id;        this.daily_check_info = [];        this.crucialInfoData(params);      }    },  },  mounted() {    this.type = this.$route.params.type;    const params = '?' + this.type + '=' + this.$route.params.id;    const weekId = this.$route.params.weekId;    this.weekDate = this.getWeek(weekId);    this.crucialInfoData(params);    this.getThisWeekPlanByDate(params);  },  methods: {    async crucialInfoData(params) {      const urlPath = this.weekDate;      const urlData = urlPath + '/' + params;      const response = await this.$store.dispatch(        'getCrucialInfoData',        urlData      );      if (response.status === 200) {        this.employee_checklist = response.data.employee_checklist;        this.daily_check_info = this.employee_checklist.daily_check_info;      }    },    async getThisWeekPlanByDate(params) {      const urlPath = this.$route.params.weekId.replace('-', '/');      const urlData = urlPath + '/' + params;      const response = await this.$store.dispatch(        'getThisWeekPlanByDate',        urlData      );      if (response.status === 200) {        // this.planned_tasks = response.data.this_week_plan.slice();        const plannedTasks = response.data.this_week_plan;        for (const i in plannedTasks) {          const tempList1 = plannedTasks[i].task_stages.slice();          const tempList2 = plannedTasks[i].task_stages.slice();          for (const j in tempList1) {            const splicedList = tempList1[j].plan_hour.split(':');            let planHour = parseInt(splicedList[0]);            let planMin = parseInt(splicedList[1]);            for (const l in tempList2) {              if (                tempList1[j] &&                j !== l &&                tempList1[j].task_stage === tempList2[l].task_stage              ) {                const splicedList = tempList2[l].plan_hour.split(':');                let intPlanHour = parseInt(splicedList[0]);                let intPlanMin = parseInt(splicedList[1]);                planHour += intPlanHour;                planMin += intPlanMin;                tempList2.splice(l, 1);                tempList1.splice(l, 1);              }            }            if (planMin >= 60) {              const min = Math.floor(planMin / 60);              planMin = planMin - 60 * min;              planHour += min;            }            if (!planHour.toString().charAt(1)) {              planHour = '0' + planHour;            }            if (!planMin.toString().charAt(1)) {              planMin = '0' + planMin;            }            if (tempList1[j]) {              tempList1[j].plan_hour = planHour + ':' + planMin;            }          }          plannedTasks[i].task_stages = tempList1;        }        this.planned_tasks = plannedTasks;      }    },    getTaskDetailByDate(taskID) {      const urlPath = this.weekDate;      const urlData = urlPath + '/' + taskID + '/';      const response = this.$store.dispatch('getTaskDetailByDate', urlData);      return response;    },    getDateOfWeek(w, y) {      const d = 1 + (w - 1) * 7; // 1st of January + 7 days for each week      return new Date(y, 0, d);    },    getWeek(data) {      const array = data.toString().split('-');      const year = array[0];      const week = array[1];      // let d = 0;      // if (week === '1') {      //   d = 1 + week * 7;      // } else {      //   d = 1 + (week - 1) * 7;      // }      const d = week * 7;      const date = new Date(year, 0, d);      const day = date.getDay();      const diff = date.getDate() - day + (day === 0 ? -6 : 1);      const first = new Date(date.setDate(diff)).getDate();      const last = first + 4;      const firstday = new Date(date.setDate(first)).toUTCString();      const lastday = new Date(date.setDate(last)).toUTCString();      return this.formatDate(firstday) + '/' + this.formatDate(lastday);    },    formatDate(date) {      const d = new Date(date);      let month = '' + (d.getMonth() + 1);      let day = '' + d.getDate();      const year = d.getFullYear();      if (month.length < 2) month = '0' + month;      if (day.length < 2) day = '0' + day;      return [year, month, day].join('-');    },  },};</script><style scoped>.swiper-slide {  width: 262px !important;}</style>