<template>  <div>    <div class="w-100 flex-space-between align-items-center">      <label        v-for="item in buttons"        :key="item.id"        class="btn w-100 tabBtn align-items-center"        style="height: 40px"        :class="{ active: item.isActive }"      >        <input          :id="item.id"          type="radio"          style="display: none"          @click="activate(item)"        />        {{ item.name }}      </label>    </div>    <div style="margin-bottom: 100px">      <div v-for="item in buttons" :key="item.id">        <div v-if="item.id === 'gi' && item.isActive">          <generalInformation            :data="passData"            :type="type"            @general_data="emitGeneralData"          />        </div>        <div v-else-if="item.id === 'pc' && item.isActive">          <permissionConfiguration            :data="passData"            :type="type"            @permission_data="emitPermissionData"          />        </div>      </div>      <b-col cols="12" class="d-flex bg-secondary py-3 footer">        <b-col class="btn sendBtn mr-2" cols="10">          <p v-if="type === 'create' && !isCreated" @click="create">Create</p>          <p v-else-if="type === 'create' && isCreated" @click="setPermission">            Set permission          </p>          <p v-else @click="update">Update</p>        </b-col>        <b-col class="cancelBtn btn" cols="2">          <p @click="hide">Close</p>        </b-col>      </b-col>    </div>  </div></template><script>import generalInformation from '@/components/admininstration/job_title/side_bar/GeneralInformation';import permissionConfiguration from '@/components/admininstration/job_title/side_bar/PermissionConfiguration';export default {  name: 'JobTitleEdit',  components: {    generalInformation,    permissionConfiguration,  },  props: {    type: {      type: String,      default() {        return '';      },    },    data: {      type: Object,      default: null,    },  },  data() {    return {      buttons: {        button1: {          name: 'General Information',          id: 'gi',          icon: '',          isActive: true,          isDisabled: false,        },        button2: {          name: 'Permission Configuration',          id: 'pc',          icon: '',          isActive: false,          isDisabled: false,        },      },      sendingGeneralData: {},      sendingPermissionData: {},      isCreated: false,      passData: this.data,    };  },  mounted() {    if (this.type === 'edit') {      this.isCreated = true;      this.buttons.button2.isDisabled = false;    } else {      this.isCreated = false;      this.buttons.button2.isDisabled = true;    }  },  methods: {    emitGeneralData(data) {      const jsonData = {        updated_user: this.$store.getters.user.id,        is_active: '1',      };      if (this.type === 'create') {        jsonData.created_user = this.$store.getters.user.id;        const organizationId = this.$store.getters.activeCompany;        let groupId = null;        for (const i in this.$store.getters.user.companies) {          if (            this.$store.getters.user.companies[i].organization_id ===            organizationId          ) {            groupId = this.$store.getters.user.companies[i].group_id;          }        }        jsonData.organization_id = organizationId;        jsonData.group_id = groupId;      }      if (data.department_id) {        jsonData.department_id = data.department_id;      }      if (data.short_name) {        jsonData.short_name = data.short_name;      }      if (data.name) {        jsonData.name = data.name;      }      if (data.description) {        jsonData.description = data.description;      }      if (data.id) {        jsonData.id = data.id;      }      if (data.parent) {        jsonData.parent_id = data.parent.id;      }      if (data.salary_category) {        jsonData.salary_category_id = data.salary_category.id;      }      console.log('emitGeneralData', jsonData);      this.sendingGeneralData = jsonData;    },    emitPermissionData(data) {      this.sendingPermissionData = data;    },    async create() {      if (this.sendingGeneralData.updated_user) {        const params = {          urlParams: '',          urlData: this.sendingGeneralData,        };        const response = await this.postJobTitle(params, true);        if (response) {          const json = { item: { id: response } };          this.passData = json;          this.isCreated = true;          this.buttons.button2.isDisabled = false;          this.$root.$emit('bv::toggle::collapse', 'jobTitleSideBar');        }      }    },    async setPermission() {      const sendDataCreate = this.sendingPermissionData.sendDataCreate;      const sendDataUpdate = this.sendingPermissionData.sendDataUpdate;      for (const i in sendDataCreate) {        const param = {          urlParams: '',          urlData: sendDataCreate[i],        };        await this.postJobTitlePermission(param);      }      for (const i in sendDataUpdate) {        const param = {          urlParams: sendDataUpdate[i].id + '/',          urlData: sendDataUpdate[i],        };        await this.postJobTitlePermission(param);      }      this.hide();    },    async update() {      if (this.sendingGeneralData.updated_user) {        const params = {          urlParams: this.sendingGeneralData.id + '/',          urlData: this.sendingGeneralData,        };        await this.postJobTitle(params);      }      const sendDataCreate = this.sendingPermissionData.sendDataCreate;      const sendDataUpdate = this.sendingPermissionData.sendDataUpdate;      for (const i in sendDataCreate) {        const param = {          urlParams: '',          urlData: sendDataCreate[i],        };        console.log('postJobTitlePermissioncreate', param);        await this.postJobTitlePermission(param);      }      for (const i in sendDataUpdate) {        const param = {          urlParams: sendDataUpdate[i].id + '/',          urlData: sendDataUpdate[i],        };        console.log('postJobTitlePermissionupdate', param);        await this.postJobTitlePermission(param);      }      this.hide();    },    hide() {      this.$root.$emit('bv::toggle::collapse', 'jobTitleSideBar');    },    activate(data) {      if (!data.isDisabled) {        for (const value in this.buttons) {          if (this.buttons[value].id === data.id) {            data.isActive = true;            document.getElementById(data.id).setAttribute('checked', '');          } else {            this.buttons[value].isActive = false;            document              .getElementById(this.buttons[value].id)              .removeAttribute('checked');          }        }      }    },    async postJobTitle(params, all = false) {      const response = await this.$store.dispatch('postJobTitle', params);      if (response.status === 200 && all) {        return response.data;      }    },    async postJobTitlePermission(params) {      await this.$store.dispatch('postJobTitlePermission', params);    },  },};</script><style scoped>.tabBtn {  border: 0;  background-color: white;  color: #263a5a;  margin-top: 1px;  border-radius: 0;}.tabBtn.active {  background-color: #263a5a;  color: white;}.sendBtn {  background-color: #263a5a;  color: white;}.cancelBtn {  background-color: white;  color: #263a5a;  border: solid 2px #263a5a;}.footer {  z-index: 1;  position: absolute;  bottom: 0;}</style>