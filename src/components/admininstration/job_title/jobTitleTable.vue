<template>  <div>    <ContentHeader>      <template #text>        <h4 class="font-weight-bold mb-3">Lets jump start</h4>        <p>          Welcome to our planet TUS D+. We have so much in store for you and          your company. So, letâ€™s jump start your journey with a tutorial!        </p>      </template>      <template #image>        <img          src="@/assets/images/administration/admin-content-header.svg"          class="content-header-image"          alt=""        />      </template>    </ContentHeader>    <div class="d-flex justify-content-between align-items-center w-100 mb-4">      <b-input-group class="search-form">        <template #append>          <b-input-group-text>            <Fa :icon="['fas', 'search']" />          </b-input-group-text>        </template>        <b-form-input          v-model="searchData"          id="search-task"          placeholder="Search"        ></b-form-input>      </b-input-group>      <b-button        v-if="jbttCrt"        v-b-toggle.jobTitleSideBar        @click="create"        variant="deep-blue"      >        <Fa :icon="['fas', 'plus']" />        Create new Job Title      </b-button>    </div>    <b-table      id="jobTitletable"      ref="jobTitletable"      striped      :sort-by.sync="sortBy"      :fields="tableField"      :items="tableData"    >      <template #cell(sequence)="props">        {{ props.index + 1 }}      </template>      <template #cell(action)="props">        <a          v-b-toggle.jobTitleSideBar          v-if="jbttUpd"          class="cursor-pointer"          @click="edit(props)"        >          <Fa :icon="['fas', 'cog']" />          Edit        </a>      </template>    </b-table>    <b-sidebar      id="jobTitleSideBar"      ref="jobTitleSideBar"      title="Job Title"      v-model="isJobTitleSideBarClose"      right      shadow      backdrop      lazy      class="sidebar-lg"    >      <jobTitleSideBar :type="sideBarType" :data="sideBarData" />    </b-sidebar>  </div></template><script>import ContentHeader from '@/components/admininstration/ContentHeader';import jobTitleSideBar from '@/components/admininstration/job_title/jobTitleEdit';export default {  name: 'JobTitleTable',  components: {    ContentHeader,    jobTitleSideBar,  },  data() {    return {      sortBy: 'department',      searchData: '',      tableField: [        {          key: 'sequence',          label: '',        },        {          key: 'short_name',          label: 'Short name',          sortable: true,        },        {          key: 'name',          label: 'Job title name',          sortable: true,        },        {          key: 'department',          label: 'Department',          sortable: true,        },        {          key: 'salary',          label: 'Salary',        },        {          key: 'action',          label: 'Action',        },      ],      jobTitles: [],      tableData: [],      salaryCategory: [],      sideBarType: '',      sideBarData: null,      jbttRed: this.permission('jbtt_red'),      jbttCrt: this.permission('jbtt_crt'),      jbttUpd: this.permission('jbtt_upd'),      jbttDel: this.permission('jbtt_del'),      isJobTitleSideBarClose: false,    };  },  watch: {    isJobTitleSideBarClose(data) {      if (!data) {        const param = `?is_active=1&page_size=1000&organization=      ${this.$store.getters.activeCompany}`;        this.getCompanyJobTitles(param);        this.getSalaryCategory(param);      }    },    searchData(data) {      if (data) {        this.tableData = [];        for (const i in this.jobTitles) {          const name = this.jobTitles[i].name;          if (name.toLowerCase().includes(data)) {            this.tableData.push(this.jobTitles[i]);          }        }      } else {        this.tableData = this.jobTitles;      }    },    jobTitles(data) {      const departments = this.$store.getters.company.department;      for (const j in data) {        for (const i in departments) {          if (departments[i].id === data[j].department) {            this.jobTitles[j].department = departments[i].short_name;            this.jobTitles[j].department_id = departments[i].id;          }        }        for (const i in this.salaryCategory) {          if (this.salaryCategory[i].id === data[j].salary_category) {            this.jobTitles[j].salary = this.salaryCategory[i].name;            this.jobTitles[j].salary_id = this.salaryCategory[i].id;          }        }      }    },  },  beforeMount() {    const param = `?is_active=1&page_size=1000&organization=      ${this.$store.getters.activeCompany}`;    this.getCompanyJobTitles(param);    this.getSalaryCategory(param);  },  methods: {    async getSalaryCategory(params) {      const response = await this.$store.dispatch('getSalaryCategory', params);      if (response.status === 200) {        this.salaryCategory = response.data.results;      }    },    async getCompanyJobTitles(params) {      const response = await this.$store.dispatch(        'getCompanyJobTitles',        params      );      if (response.status === 200) {        this.jobTitles = response.data.results;        this.tableData = this.jobTitles;      }    },    create() {      this.sideBarType = 'create';      this.sideBarData = { item: {} };    },    edit(data) {      this.sideBarType = 'edit';      this.sideBarData = data;    },  },};</script>