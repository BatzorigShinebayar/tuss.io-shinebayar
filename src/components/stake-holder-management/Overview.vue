<template>  <b-col cols="12">    <b-col cols="12" class="d-flex mt-5 mb-3">      <b-input-group v-if="pagination" class="search-form">        <template #append>          <b-input-group-text class="bg-secondary text-dark">            <Fa :icon="['fas', 'search']" />          </b-input-group-text>        </template>        <b-form-input          v-model="searchData"          class="bg-secondary text-dark"          id="search-task"          placeholder="Search"        ></b-form-input>      </b-input-group>      <div class="ml-auto d-flex align-items-center">        <div class="mr-4 bg-secondary">          <div            class="btn"            @click="setMenu('grid')"            :class="{ active: menuType === 'grid' }"          >            <Fa              :icon="['far', 'th-large']"              :class="{ 'text-primary': menuType === 'grid' }"            />          </div>          <div            class="btn"            @click="setMenu('list')"            :class="{ active: menuType === 'list' }"          >            <Fa              :icon="['fas', 'list-ul']"              :class="{ 'text-primary': menuType === 'list' }"            />          </div>        </div>        <b-button @click="create" variant="deep-blue">          <Fa :icon="['fas', 'plus']" />          Add Stakeholder        </b-button>      </div>    </b-col>    <b-col cols="12" v-if="menuType === 'list'">      <b-table        id="stakeholders"        ref="stakeholders"        striped        :fields="tableField"        :items="stakeholders"      >        <template #cell(sequence)="props">          {{ props.index + 1 }}        </template>        <template #cell(name)="props">          <router-link            :to="{              name: 'stake-holder-detail',              params: {                id: props.item.partner_id,              },            }"            class="task-link"          >            {{ props.item.name }}          </router-link>        </template>        <template #cell(action)>          <a class="float-right cursor-pointer">            <Fa class="mx-1" :icon="['far', 'edit']" />            <Fa class="mx-1" :icon="['fas', 'trash']" />          </a>        </template>        <template #cell(image)="props">          <img            :src="props.item.image"            onError="this.onerror=null;this.src='https://tuss.io/tusd_images/profile/human_icon.png';"            class="avatar-xs"            alt          />        </template>      </b-table>    </b-col>    <b-col      class="d-flex"      style="flex-wrap: wrap"      cols="12"      v-if="menuType === 'grid' && $route.params.type !== 'organization'"    >      <div class="mx-3" v-for="(item, index) in stakeholders" :key="index">        <StakeHolderCard :card-data="item" />      </div>    </b-col>    <b-col      cols="12"      v-else-if="menuType === 'grid' && $route.params.type === 'organization'"    >      <StakeHoldersOrgView />      <div class="mt-4">        <div v-for="(stakeHolders, index) in partner_types" :key="index">          <StakeHoldersPartnerTypes            :data="stakeHolders"            @partner_type="emitted_partner_type"          />        </div>        <b-col class="mt-3" cols="12">          <b-button            @click="addPartnerType"            class="align-self-center ml-auto"            variant="deep-blue"          >            <Fa :icon="['fas', 'plus']" />            Add stakeholder type          </b-button>        </b-col>      </div>    </b-col>    <b-col v-if="pagination" cols="12">      <div class="d-flex justify-content-center mt-4">        <b-pagination-nav          pills          :link-gen="linkGen"          :number-of-pages="            stakeholders.length <= 50 ? 1 : stakeholders.length / 50          "          use-router          first-number          last-number        ></b-pagination-nav>      </div>      <p class="text-right">Нийт: {{ stakeholders.length }}</p>    </b-col>    <sideBarCreate :partner-type="partner_type" />  </b-col></template><script>import StakeHolderCard from '@/components/stake-holder-management/items/StakeholderCard';import StakeHoldersOrgView from '@/components/stake-holder-management/items/StakeHoldersOrgView';import StakeHoldersPartnerTypes from '@/components/stake-holder-management/items/StakeHoldersPartnerTypes';import sideBarCreate from '@/components/stake-holder-management/items/sideBarCreate';export default {  name: 'StakeHoldersOverview',  components: {    StakeHolderCard,    StakeHoldersOrgView,    StakeHoldersPartnerTypes,    sideBarCreate,  },  data() {    return {      searchData: '',      stakeholders: [],      tableField: [],      menuType: 'grid',      sequence: {        key: 'sequence',        label: '',      },      pagination: true,      partner_types: null,      partner_type: null,    };  },  watch: {},  mounted() {    const d = new Date();    this.thisYear = d.getFullYear().toString();    const type = this.$route.params.type;    let params = `?${this.$route.params.type}=${this.$route.params.id}`;    if (type === 'partner_type') {      params = `?organization=${this.$store.getters.activeCompany}&partner_type=${this.$route.params.id}`;    }    this.getPartnerTypeRel(params);    if (this.menuType === 'grid' && type === 'organization') {      this.pagination = false;    } else {      this.pagination = true;    }  },  methods: {    emitted_partner_type(data) {      this.partner_type = data;    },    addPartnerType() {      this.$router.push({        name: 'stake-holders',      });    },    async getPartnerTypeRel(params) {      const response = await this.$store.dispatch('getPartnerTypeRel', params);      if (response.status === 200) {        const data = response.data;        this.stakeholders = [];        this.partner_types = [];        for (const i in data.partner_types) {          for (const j in data.partner_types[i].partners) {            this.stakeholders.push(data.partner_types[i].partners[j]);            this.tableField = [];            for (const l in data.partner_types[i].partners[j]) {              if (!l.includes('id') && !l.includes('json')) {                this.tableField.push(l);              }            }          }          this.partner_types.push(data.partner_types[i]);        }        this.tableField.unshift(this.sequence);      }    },    create() {      this.$root.$emit('bv::toggle::collapse', 'sideBarPartnerCreate');    },    setMenu(type) {      this.menuType = type;      if (type === 'grid' && this.$route.params.type === 'organization') {        this.pagination = false;      } else {        this.pagination = true;      }    },    showTaskDetail(rowData) {      this.$set(        this.stakeholders[rowData.index],        '_showDetails',        !this.stakeholders[rowData.index]._showDetails      );    },    linkGen(pageNum) {      return pageNum === 1 ? '?' : `?page=${pageNum}`;    },  },};</script><style scoped>.active {  border: #4276d0 2px solid !important;}</style>