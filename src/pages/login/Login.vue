<template>  <div class="login-panel" @mousemove="mouseMove">    <div class="login-panel-content">      <div        class="login-panel-content-background"        :style="{          backgroundPosition: mouseX + 'px ' + mouseY + 'px',        }"      >        <router-link tag="a" to="/" class="d-block">          <img            class="login-logo-img"            src="@/assets/images/tusd_logo_white.svg"            alt="TUSD+"          />        </router-link>        <img          src="@/assets/images/login/astranaut.webp"          class="login-astranaut"          alt=""        />      </div>      <div class="login-panel-content-control">        <div class="login-form">          <router-link tag="a" to="/" class="d-block">            <img              class="login-form-mobile-logo"              src="@/assets/images/tusd_logo.svg"              alt="TUSD+"            />          </router-link>          <h1 class="text-center">Welcome</h1>          <p class="text-center mb-lg-4 mb-2">Are you ready work?</p>          <b-alert v-if="loginError" class="mt-3" show variant="danger">            {{ loginError }}          </b-alert>          <b-form class="p-2 mb-3" @submit.prevent="authenticate">            <b-form-group              id="login-username-group"              label="E-Mail"              label-for="login-username"            >              <b-form-input                id="login-username"                v-model="email"                :class="{                  'is-invalid':                    (!$v.email.required && loginSubmit) ||                    (!$v.email.email && loginSubmit),                }"                type="text"                autocomplete="on"              ></b-form-input>              <span v-if="!$v.email.required && loginSubmit" class="text-danger"                >E-mail is required</span              >              <span v-if="!$v.email.email && loginSubmit" class="text-danger"                >E-mail is invalid</span              >            </b-form-group>            <b-form-group              id="login-password-group"              label="Password"              label-for="login-password"            >              <b-form-input                id="login-password"                v-model="password"                :class="{                  'is-invalid': !$v.password.required && loginSubmit,                }"                type="password"                spellcheck="false"              >              </b-form-input>              <span                v-if="!$v.password.required && loginSubmit"                class="text-danger"              >                Enter your password</span              >            </b-form-group>            <div class="mt-3">              <b-button                block                variant="dark"                class="mt-4"                type="submit"                :disabled="loginPending"                size="lg"              >                Sign In              </b-button>            </div>            <div class="mt-4 text-center">              <router-link                class="password_recovery"                :to="{ name: 'forgot-password' }"              >                <Fa :icon="['fas', 'key']" /> Forgot Password?              </router-link>            </div>          </b-form>          <div class="p-2 mt-2">            <GoogleLogin              :params="params"              :onSuccess="onSuccess"              :onFailure="onFailure"              id="google-login"              class="btn btn-block btn-outline-dark btn-lg"            >              <Fa :icon="['fab', 'google']" />              Login with Google            </GoogleLogin>          </div>        </div>      </div>    </div>    <img id="login-star" src="@/assets/images/login/star.webp" alt="" />  </div></template><script>import { email, required } from 'vuelidate/lib/validators';import { GoogleLogin } from 'vue-google-login';import axios from 'axios';export default {  name: 'LoginPage',  components: {    GoogleLogin,  },  data() {    return {      email: null,      password: null,      loginError: false,      loginPending: false,      loginSubmit: false,      mouseX: null,      mouseY: null,      params: {        client_id:          '635183532065-jv6kd8skpqo01tlq8fp2i6c4msod8ghk.apps.googleusercontent.com',        scope:          'openid profile email https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://mail.google.com/ https://www.googleapis.com/auth/user.emails.read https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/gmail.metadata https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/contacts https://www.googleapis.com/auth/contacts.readonly https://www.googleapis.com/auth/contacts.other.readonly https://www.googleapis.com/auth/user.birthday.read',        secret: 'L9XFMPQ89htSa0GrFL_A534h',        key: 'AIzaSyAwAfMkayZwFT2k_ftBQF4lkbYn4XRIv0U',      },    };  },  validations: {    email: { required, email },    password: { required },  },  metaInfo: {    title: 'Sign in | TUSS D+',  },  methods: {    async authenticate() {      this.loginSubmit = true;      this.$v.$touch();      if (!this.$v.$invalid) {        this.loginPending = true;        const payload = {          username: String(this.email).toLowerCase().trim(),          password: this.password,        };        await this.$store          .dispatch('token', payload)          .then(() => {            this.loginError = false;          })          .catch((error) => {            this.loginPending = false;            this.loginError = true;            if (error.response) {              if (error.response.status === 401) {                this.loginError = 'Username or password is wrong';              } else {                this.loginError = 'Something wrong...';              }            } else {              this.loginError = 'Cannot connect to the server...';            }          });        if (!this.loginError) {          this.$store.dispatch('company').then(() => {            this.$router.push('/crucial-information');          });        }      }    },    onSuccess(googleUser) {      const googleAuthData = {        access_token: googleUser.getAuthResponse().access_token,        email_verified: true,        email: googleUser.getBasicProfile().getEmail(),        hd: googleUser.getHostedDomain(),        picture: googleUser.getBasicProfile().getImageUrl(),        sub: googleUser.getBasicProfile().getFamilyName(),      };      axios        .post('/social-login/google/', googleAuthData)        .then((response) => {          const token = `Bearer ${response.data.access}`;          axios.defaults.headers.common['Authorization'] = token;          this.$store.commit('setToken', token);          this.$store.commit('user', response.data.user);          this.$store.commit('activeCompany', response.data.user.company_id);          this.$store.dispatch('company').then(() => {            this.$router.push('/crucial-information');          });        })        .catch((error) => {          console.log(error.response);          this.loginError = 'Google login error...';        });    },    onFailure(googleUser) {      console.log('Google login fail:', googleUser);      this.loginError = 'Google login error...';    },    mouseMove(event) {      const movementStrength = 25;      const height = movementStrength / window.innerHeight;      const width = movementStrength / window.innerWidth;      const pageX = event.clientX - window.innerWidth / 2;      const pageY = event.clientY - window.innerHeight / 2;      this.mouseX = width * pageX * -1 - 25;      this.mouseY = height * pageY * -1 - 50;    },  },};</script>